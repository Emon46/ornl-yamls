apiVersion: kubedb.com/v1alpha2
kind: Postgres
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"kubedb.com/v1alpha2","kind":"Postgres","metadata":{"annotations":{},"name":"demo-pg-2","namespace":"demo"},"spec":{"monitor":{"agent":"prometheus.io/operator","prometheus":{"serviceMonitor":{"labels":{"release":"kube-prometheus-stack"}}}},"replicas":3,"standbyMode":"Hot","storage":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"storageClassName":"linode-block-storage"},"storageType":"Durable","terminationPolicy":"WipeOut","version":"11.11-pg-0.6.0-raft-new"}}
  creationTimestamp: "2022-04-12T11:43:00Z"
  finalizers:
  - kubedb.com
  generation: 2
  name: demo-pg-2
  namespace: demo
  resourceVersion: "36099"
  uid: 9eef8abf-e642-43f6-bb34-c6f6cb802d14
spec:
  allowedSchemas:
    namespaces:
      from: Same
  authSecret:
    name: demo-pg-2-auth
  clientAuthMode: md5
  coordinator:
    resources:
      limits:
        memory: 256Mi
      requests:
        cpu: 200m
        memory: 256Mi
  leaderElection:
    electionTick: 10
    heartbeatTick: 1
    maximumLagBeforeFailover: 67108864
    period: 300ms
  monitor:
    agent: prometheus.io/operator
    prometheus:
      exporter:
        port: 56790
        resources: {}
      serviceMonitor:
        labels:
          release: kube-prometheus-stack
  podTemplate:
    controller: {}
    metadata: {}
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app.kubernetes.io/instance: demo-pg-2
                  app.kubernetes.io/managed-by: kubedb.com
                  app.kubernetes.io/name: postgreses.kubedb.com
              namespaces:
              - demo
              topologyKey: kubernetes.io/hostname
            weight: 100
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app.kubernetes.io/instance: demo-pg-2
                  app.kubernetes.io/managed-by: kubedb.com
                  app.kubernetes.io/name: postgreses.kubedb.com
              namespaces:
              - demo
              topologyKey: failure-domain.beta.kubernetes.io/zone
            weight: 50
      containerSecurityContext:
        capabilities:
          add:
          - IPC_LOCK
          - SYS_RESOURCE
        privileged: false
        runAsGroup: 999
        runAsUser: 999
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 500m
          memory: 1Gi
      securityContext:
        fsGroup: 999
        runAsGroup: 999
        runAsUser: 999
      serviceAccountName: demo-pg-2
  replicas: 3
  sslMode: disable
  standbyMode: Hot
  storage:
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: 1Gi
    storageClassName: linode-block-storage
  storageType: Durable
  terminationPolicy: WipeOut
  version: 11.11-pg-0.6.0-raft-new
status:
  conditions:
  - lastTransitionTime: "2022-04-12T11:43:01Z"
    message: 'The KubeDB operator has started the provisioning of Postgres: demo/demo-pg-2'
    reason: DatabaseProvisioningStartedSuccessfully
    status: "True"
    type: ProvisioningStarted
  - lastTransitionTime: "2022-04-12T11:44:58Z"
    message: 'The PostgreSQL: demo/demo-pg-2 is accepting client requests.'
    observedGeneration: 2
    reason: DatabaseAcceptingConnectionRequest
    status: "True"
    type: AcceptingConnection
  - lastTransitionTime: "2022-04-12T11:46:16Z"
    message: DB is ready because of server getting Online and Running state
    observedGeneration: 2
    reason: ReadinessCheckSucceeded
    status: "True"
    type: Ready
  - lastTransitionTime: "2022-04-12T11:46:16Z"
    message: All replicas are ready and in Running state
    observedGeneration: 2
    reason: AllReplicasReady
    status: "True"
    type: ReplicaReady
  - lastTransitionTime: "2022-04-12T11:46:17Z"
    message: 'The PostgreSQL: demo/demo-pg-2 is successfully provisioned.'
    observedGeneration: 2
    reason: DatabaseSuccessfullyProvisioned
    status: "True"
    type: Provisioned
  observedGeneration: 2
  phase: Ready
